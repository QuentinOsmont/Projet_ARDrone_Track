<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Urbi SDK Remote: uobject.hh Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath">
    <ul>
      <li><a class="el" href="dir_03c25b13d14c5db4475ec8bbd24b0f1f.html">source</a>      </li>
      <li><a class="el" href="dir_218aef791fc34308040010d988450d4d.html">sdk-remote</a>      </li>
      <li><a class="el" href="dir_1c34992c2bac9c7c62403c9b6e9763cd.html">include</a>      </li>
      <li><a class="el" href="dir_71d1b51b086519cf312ed1872cbd4654.html">urbi</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>uobject.hh</h1>  </div>
</div>
<div class="contents">
<a href="uobject_8hh.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * Copyright (C) 2009, 2010, Gostai S.A.S.</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * This software is provided &quot;as is&quot; without warranty of any kind,</span>
<a name="l00005"></a>00005 <span class="comment"> * either expressed or implied, including but not limited to the</span>
<a name="l00006"></a>00006 <span class="comment"> * implied warranties of fitness for a particular purpose.</span>
<a name="l00007"></a>00007 <span class="comment"> *</span>
<a name="l00008"></a>00008 <span class="comment"> * See the LICENSE file for more information.</span>
<a name="l00009"></a>00009 <span class="comment"> */</span>
<a name="l00010"></a>00010 
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 <span class="preprocessor">#ifndef URBI_UOBJECT_HH</span>
<a name="l00014"></a>00014 <span class="preprocessor"></span><span class="preprocessor"># define URBI_UOBJECT_HH</span>
<a name="l00015"></a>00015 <span class="preprocessor"></span>
<a name="l00016"></a>00016 <span class="preprocessor"># include &lt;libport/warning-push.hh&gt;</span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="preprocessor"># include &lt;string&gt;</span>
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="preprocessor"># include &lt;libport/cmath&gt;</span>
<a name="l00021"></a>00021 <span class="preprocessor"># include &lt;libport/compiler.hh&gt;</span>
<a name="l00022"></a>00022 <span class="preprocessor"># include &lt;libport/fwd.hh&gt;</span>
<a name="l00023"></a>00023 <span class="preprocessor"># include &lt;libport/preproc.hh&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor"># include &lt;libport/thread-pool.hh&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor"># include &lt;libport/ufloat.h&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor"># include &lt;libport/utime.hh&gt;</span>
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="preprocessor"># include &lt;<a class="code" href="export_8hh.html">urbi/export.hh</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor"># include &lt;<a class="code" href="fwd_8hh.html" title="Forward declarations.">urbi/fwd.hh</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor"># include &lt;<a class="code" href="kernel-version_8hh.html">urbi/kernel-version.hh</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor"># include &lt;<a class="code" href="ucallbacks_8hh.html">urbi/ucallbacks.hh</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor"># include &lt;<a class="code" href="uevent_8hh.html">urbi/uevent.hh</a>&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor"># include &lt;<a class="code" href="utimer-callback_8hh.html">urbi/utimer-callback.hh</a>&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor"># include &lt;<a class="code" href="uvar_8hh.html">urbi/uvar.hh</a>&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor"># include &lt;<a class="code" href="uobject-hub_8hh.html">urbi/uobject-hub.hh</a>&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor"># include &lt;<a class="code" href="ucontext_8hh.html">urbi/ucontext.hh</a>&gt;</span>
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 <span class="comment">// Tell our users that it is fine to use void returning functions.</span>
<a name="l00039"></a><a class="code" href="uobject_8hh.html#ab4d7bfb270b7e3883fd5eef258542b12">00039</a> <span class="preprocessor">#define USE_VOID 1</span>
<a name="l00040"></a>00040 <span class="preprocessor"></span>
<a name="l00041"></a><a class="code" href="uobject_8hh.html#a20a3255315a8d049b933e26493e715f6">00041</a> <span class="preprocessor">#define URBI_UOBJECT_VERSION 2</span>
<a name="l00042"></a>00042 <span class="preprocessor"></span>
<a name="l00048"></a><a class="code" href="uobject_8hh.html#a6fa26a75d3e6c81a737fc55f406fb43f">00048</a> <span class="preprocessor"># define UBindVarRename(Obj,X,Uname) \</span>
<a name="l00049"></a>00049 <span class="preprocessor">  (X).init(__name, Uname, ctx_)</span>
<a name="l00050"></a>00050 <span class="preprocessor"></span>
<a name="l00051"></a><a class="code" href="uobject_8hh.html#ad5a7e079097d95b82f81614b49aebcd0">00051</a> <span class="preprocessor"># define UBindVar(Obj,X) \</span>
<a name="l00052"></a>00052 <span class="preprocessor">  UBindVarRename(Obj, X, #X)</span>
<a name="l00053"></a>00053 <span class="preprocessor"></span>
<a name="l00055"></a><a class="code" href="uobject_8hh.html#a8bf80f9938ed5405f90f132973a01fd9">00055</a> <span class="preprocessor"># define UBindVars(Obj, ...) \</span>
<a name="l00056"></a>00056 <span class="preprocessor">  LIBPORT_VAARGS_APPLY(URBI_BINDVARS, Obj, __VA_ARGS__)</span>
<a name="l00057"></a>00057 <span class="preprocessor"></span>
<a name="l00058"></a>00058 
<a name="l00064"></a><a class="code" href="uobject_8hh.html#af7f14af8b92c9d6591eaae1f285de58e">00064</a> <span class="preprocessor"># define UBindEventRename(Obj,X,Uname) \</span>
<a name="l00065"></a>00065 <span class="preprocessor">  (X).init(__name, Uname, ctx_)</span>
<a name="l00066"></a>00066 <span class="preprocessor"></span>
<a name="l00067"></a><a class="code" href="uobject_8hh.html#a7786a46354811ee329bcbfc181077dd6">00067</a> <span class="preprocessor"># define UBindEvent(Obj,X) \</span>
<a name="l00068"></a>00068 <span class="preprocessor">  UBindEventRename(Obj, X, #X)</span>
<a name="l00069"></a>00069 <span class="preprocessor"></span>
<a name="l00070"></a><a class="code" href="uobject_8hh.html#ac466cd0d63515c6f871afc845e60d41f">00070</a> <span class="preprocessor"># define UBindEvents(Obj, ...) \</span>
<a name="l00071"></a>00071 <span class="preprocessor">  LIBPORT_VAARGS_APPLY(URBI_BINDEVENTS, Obj, __VA_ARGS__)</span>
<a name="l00072"></a>00072 <span class="preprocessor"></span>
<a name="l00080"></a><a class="code" href="uobject_8hh.html#ae3bff59c316d90d494a72182134c721d">00080</a> <span class="preprocessor"># define UOwned(X) \</span>
<a name="l00081"></a>00081 <span class="preprocessor">  (X).setOwned()</span>
<a name="l00082"></a>00082 <span class="preprocessor"></span>
<a name="l00084"></a><a class="code" href="uobject_8hh.html#a4d8c097200224ac62b6c0440521f466b">00084</a> <span class="preprocessor"># define USensor(X) \</span>
<a name="l00085"></a>00085 <span class="preprocessor">  UOwned(X)</span>
<a name="l00086"></a>00086 <span class="preprocessor"></span>
<a name="l00088"></a><a class="code" href="uobject_8hh.html#abf9d3913a171cbee942f9d0312636488">00088</a> <span class="preprocessor">#define CREATE_CLASS_LOCK   \</span>
<a name="l00089"></a>00089 <span class="preprocessor">virtual libport::ThreadPool::rTaskLock getClassTaskLock() {\</span>
<a name="l00090"></a>00090 <span class="preprocessor">  static libport::ThreadPool::rTaskLock tl(new libport::ThreadPool::TaskLock); \</span>
<a name="l00091"></a>00091 <span class="preprocessor">  return tl;  \</span>
<a name="l00092"></a>00092 <span class="preprocessor">}</span>
<a name="l00093"></a>00093 <span class="preprocessor"></span>
<a name="l00099"></a><a class="code" href="uobject_8hh.html#a3c3c65f1bac667a1ae56b932f8409fa6">00099</a> <span class="preprocessor"># define UBindFunctionRename(Obj, X, Uname) \</span>
<a name="l00100"></a>00100 <span class="preprocessor">   ::urbi::createUCallback(*this, 0, &quot;function&quot;, static_cast&lt;Obj*&gt;(this), \</span>
<a name="l00101"></a>00101 <span class="preprocessor">                          (&amp;Obj::X), __name + &quot;.&quot; Uname)</span>
<a name="l00102"></a>00102 <span class="preprocessor"></span>
<a name="l00103"></a><a class="code" href="uobject_8hh.html#af115894c6a62710a37be349418e835cb">00103</a> <span class="preprocessor"># define UBindFunction(Obj, X)                                           \</span>
<a name="l00104"></a>00104 <span class="preprocessor">  UBindFunctionRename(Obj, X, #X)</span>
<a name="l00105"></a>00105 <span class="preprocessor"></span>
<a name="l00106"></a><a class="code" href="uobject_8hh.html#ac82ea4d4b6b9ad112cb57070b6412dc9">00106</a> <span class="preprocessor"># define UBindFunctions(Obj, ...)  \</span>
<a name="l00107"></a>00107 <span class="preprocessor">  LIBPORT_VAARGS_APPLY(URBI_BINDFUNCTIONS, Obj, __VA_ARGS__)</span>
<a name="l00108"></a>00108 <span class="preprocessor"></span>
<a name="l00115"></a><a class="code" href="uobject_8hh.html#a7ad9da60b4981f7277092d1560c716ed">00115</a> <span class="preprocessor"># define UBindThreadedFunctionRename(Obj, X, Uname, lockMode) \</span>
<a name="l00116"></a>00116 <span class="preprocessor">  ::urbi::createUCallback(*this, 0, &quot;function&quot;, static_cast&lt;Obj*&gt;(this), \</span>
<a name="l00117"></a>00117 <span class="preprocessor">                          (&amp;Obj::X), __name + &quot;.&quot; Uname)                 \</span>
<a name="l00118"></a>00118 <span class="preprocessor">  -&gt;setAsync(getTaskLock(lockMode, Uname))</span>
<a name="l00119"></a>00119 <span class="preprocessor"></span>
<a name="l00120"></a><a class="code" href="uobject_8hh.html#a89a8be13daf8c2d5cf28321360bb504b">00120</a> <span class="preprocessor"># define UBindThreadedFunction(Obj, X, lockMode)                         \</span>
<a name="l00121"></a>00121 <span class="preprocessor">  UBindThreadedFunctionRename(Obj, X, #X, lockMode);</span>
<a name="l00122"></a>00122 <span class="preprocessor"></span>
<a name="l00123"></a>00123 
<a name="l00128"></a><a class="code" href="uobject_8hh.html#a1b31020a608ed4edb14fca479d61a26b">00128</a> <span class="preprocessor"># define UAt(Obj, X)                                                    \</span>
<a name="l00129"></a>00129 <span class="preprocessor">::urbi::createUCallback(*this, 0, &quot;event&quot;, this,                        \</span>
<a name="l00130"></a>00130 <span class="preprocessor">                          (&amp;Obj::X), __name + &quot;.&quot; #X)</span>
<a name="l00131"></a>00131 <span class="preprocessor"></span>
<a name="l00133"></a><a class="code" href="uobject_8hh.html#a9b3736110509f78ed45390657540f101">00133</a> <span class="preprocessor"># define UThreadedAt(Obj, X, lockMode)                                  \</span>
<a name="l00134"></a>00134 <span class="preprocessor">  UAt(Obj, X)-&gt;setAsync(getTaskLock(lockMode, #X))</span>
<a name="l00135"></a>00135 <span class="preprocessor"></span>
<a name="l00136"></a>00136 
<a name="l00143"></a><a class="code" href="uobject_8hh.html#aebf4a139c466eda6f91b7a10b145f204">00143</a> <span class="preprocessor"># define UAtEnd(Obj, X, Fun)                                            \</span>
<a name="l00144"></a>00144 <span class="preprocessor">  ::urbi::createUCallback(*this, 0, &quot;eventend&quot;, this,                   \</span>
<a name="l00145"></a>00145 <span class="preprocessor">                          (&amp;Obj::X),(&amp;Obj::Fun), __name + &quot;.&quot; #X)</span>
<a name="l00146"></a>00146 <span class="preprocessor"></span>
<a name="l00147"></a><a class="code" href="uobject_8hh.html#adbede3c727f4443437269f03b25224fd">00147</a> <span class="preprocessor"># define UThreadedAtEnd(Obj, X, Fun, lock)                              \</span>
<a name="l00148"></a>00148 <span class="preprocessor">  UAtEnd(Obj, X, Fun)-&gt;&gt;setAsync(getTaskLock(lockMode, #X))</span>
<a name="l00149"></a>00149 <span class="preprocessor"></span>
<a name="l00151"></a><a class="code" href="uobject_8hh.html#aebe2d8c94501ed212bb2b233a46874d7">00151</a> <span class="preprocessor"># define URegister(Hub)                                         \</span>
<a name="l00152"></a>00152 <span class="preprocessor">  do {                                                          \</span>
<a name="l00153"></a>00153 <span class="preprocessor">    objecthub = ::urbi::baseURBIStarterHub::find(#Hub);         \</span>
<a name="l00154"></a>00154 <span class="preprocessor">    if (objecthub)                                              \</span>
<a name="l00155"></a>00155 <span class="preprocessor">      objecthub-&gt;addMember(this);                               \</span>
<a name="l00156"></a>00156 <span class="preprocessor">    else                                                        \</span>
<a name="l00157"></a>00157 <span class="preprocessor">      ::urbi::echo(&quot;Error: hub name &#39;&quot; #Hub &quot;&#39; is unknown\n&quot;);  \</span>
<a name="l00158"></a>00158 <span class="preprocessor">  } while (0)</span>
<a name="l00159"></a>00159 <span class="preprocessor"></span>
<a name="l00160"></a>00160 
<a name="l00161"></a>00161 <span class="comment">//macro to send urbi commands</span>
<a name="l00162"></a>00162 <span class="preprocessor"># ifndef URBI</span>
<a name="l00163"></a>00163 <span class="preprocessor"></span>
<a name="l00164"></a>00164 
<a name="l00165"></a><a class="code" href="uobject_8hh.html#a069112f15417f74a9fa809b889aee6bc">00165</a> <span class="preprocessor">#   define URBI(A) \</span>
<a name="l00166"></a>00166 <span class="preprocessor">  uobject_unarmorAndSend(# A)</span>
<a name="l00167"></a>00167 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00168"></a>00168 <span class="preprocessor"></span>
<a name="l00169"></a>00169 
<a name="l00172"></a><a class="code" href="uobject_8hh.html#a3a1d346a8b941285f3aa9b2d16a0ccde">00172</a> <span class="preprocessor"># define URBI_SEND_C(C, Args)                   \</span>
<a name="l00173"></a>00173 <span class="preprocessor">  do {                                          \</span>
<a name="l00174"></a>00174 <span class="preprocessor">    std::ostringstream os;                      \</span>
<a name="l00175"></a>00175 <span class="preprocessor">    os &lt;&lt; Args;                                 \</span>
<a name="l00176"></a>00176 <span class="preprocessor">    C &lt;&lt; os.str();                              \</span>
<a name="l00177"></a>00177 <span class="preprocessor">  } while (false)</span>
<a name="l00178"></a>00178 <span class="preprocessor"></span>
<a name="l00181"></a><a class="code" href="uobject_8hh.html#ae983afd2d4a4ca28684a321a9a1f4535">00181</a> <span class="preprocessor"># define URBI_SEND_C_FLUSH(C, Args)             \</span>
<a name="l00182"></a>00182 <span class="preprocessor">  do {                                          \</span>
<a name="l00183"></a>00183 <span class="preprocessor">    std::ostringstream os;                      \</span>
<a name="l00184"></a>00184 <span class="preprocessor">    os &lt;&lt; Args;                                 \</span>
<a name="l00185"></a>00185 <span class="preprocessor">    (C) &lt;&lt; os.str() &lt;&lt; std::endl;               \</span>
<a name="l00186"></a>00186 <span class="preprocessor">  } while (false)</span>
<a name="l00187"></a>00187 <span class="preprocessor"></span>
<a name="l00188"></a>00188 
<a name="l00189"></a><a class="code" href="uobject_8hh.html#a1a2eefb6ff9a1c35c8821af4d1c0f79d">00189</a> <span class="preprocessor"># define URBI_SEND(Args)                        \</span>
<a name="l00190"></a>00190 <span class="preprocessor">  URBI_SEND_C(URBI(()), Args)</span>
<a name="l00191"></a>00191 <span class="preprocessor"></span>
<a name="l00193"></a><a class="code" href="uobject_8hh.html#ae2ae93bf93e8afd08ca13cbf6a41b97f">00193</a> <span class="preprocessor"># define URBI_SEND_COMMAND_C(C, Args)           \</span>
<a name="l00194"></a>00194 <span class="preprocessor">  URBI_SEND_C_FLUSH(C, Args &lt;&lt; &#39;;&#39;)</span>
<a name="l00195"></a>00195 <span class="preprocessor"></span>
<a name="l00196"></a><a class="code" href="uobject_8hh.html#a41b615431469a35c50becd0743e3af7c">00196</a> <span class="preprocessor"># define URBI_SEND_COMMAND(Args)                \</span>
<a name="l00197"></a>00197 <span class="preprocessor">  URBI_SEND_COMMAND_C(URBI(()), Args)</span>
<a name="l00198"></a>00198 <span class="preprocessor"></span>
<a name="l00202"></a><a class="code" href="uobject_8hh.html#aafc97653a953786ff9a0fe791fb6ba9a">00202</a> <span class="preprocessor"># define URBI_SEND_PIPED_COMMAND_C(C, Args)     \</span>
<a name="l00203"></a>00203 <span class="preprocessor">  URBI_SEND_C(C, Args &lt;&lt; &#39;|&#39; &lt;&lt; std::endl)</span>
<a name="l00204"></a>00204 <span class="preprocessor"></span>
<a name="l00205"></a><a class="code" href="uobject_8hh.html#a16d4cdd2b6ff228f54db8548243630ed">00205</a> <span class="preprocessor"># define URBI_SEND_PIPED_COMMAND(Args)          \</span>
<a name="l00206"></a>00206 <span class="preprocessor">  URBI_SEND_PIPED_COMMAND_C(URBI(()), Args)</span>
<a name="l00207"></a>00207 <span class="preprocessor"></span>
<a name="l00208"></a><a class="code" href="uobject_8hh.html#aebc88dc3f91dbf31849e5f45837fcb5b">00208</a> <span class="preprocessor"># define URBI_SEND_COMMA_COMMAND_C(C, Args)     \</span>
<a name="l00209"></a>00209 <span class="preprocessor">  URBI_SEND_C_FLUSH(C, Args &lt;&lt; &#39;,&#39;)</span>
<a name="l00210"></a>00210 <span class="preprocessor"></span>
<a name="l00211"></a><a class="code" href="uobject_8hh.html#a5cd47c86e6956e2036cd8790e666b7b6">00211</a> <span class="preprocessor"># define URBI_SEND_COMMA_COMMAND(Args)          \</span>
<a name="l00212"></a>00212 <span class="preprocessor">  URBI_SEND_COMMA_COMMAND_C(URBI(()), Args)</span>
<a name="l00213"></a>00213 <span class="preprocessor"></span>
<a name="l00214"></a>00214 <span class="keyword">namespace </span>urbi
<a name="l00215"></a>00215 {
<a name="l00216"></a>00216 
<a name="l00221"></a><a class="code" href="namespaceurbi.html#a4dec125e7df86e9542d1d9ea9906a433">00221</a>   <span class="keyword">enum</span> <a class="code" href="namespaceurbi.html#a4dec125e7df86e9542d1d9ea9906a433" title="Locking model.">LockMode</a> {
<a name="l00222"></a><a class="code" href="namespaceurbi.html#a4dec125e7df86e9542d1d9ea9906a433a33b63b9bca2706af721588ab9bffc871">00222</a>       LOCK_NONE,      
<a name="l00223"></a>00223 
<a name="l00226"></a><a class="code" href="namespaceurbi.html#a4dec125e7df86e9542d1d9ea9906a433adc74c9aeaa9630fe109b969ea3b6f654">00226</a>       LOCK_FUNCTION,
<a name="l00227"></a><a class="code" href="namespaceurbi.html#a4dec125e7df86e9542d1d9ea9906a433ad24f218a6b7176b578aabad2c80bb9b8">00227</a>       LOCK_INSTANCE,  
<a name="l00228"></a><a class="code" href="namespaceurbi.html#a4dec125e7df86e9542d1d9ea9906a433ae35a4763a2d1128c068ef2582d23edde">00228</a>       LOCK_CLASS,     
<a name="l00229"></a><a class="code" href="namespaceurbi.html#a4dec125e7df86e9542d1d9ea9906a433a3dee93f55d3d5247892531d7b5c80c79">00229</a>       <a class="code" href="namespaceurbi.html#a4dec125e7df86e9542d1d9ea9906a433a3dee93f55d3d5247892531d7b5c80c79" title="Prevent parallel call to any function of this module.">LOCK_MODULE</a>     
<a name="l00230"></a>00230     };
<a name="l00231"></a>00231   UObjectHub* <a class="code" href="namespaceurbi.html#ad2cc79e5b21d7c45614ff218c31418d7">getUObjectHub</a>(<span class="keyword">const</span> std::string&amp; n);
<a name="l00232"></a>00232   UObject* <a class="code" href="namespaceurbi.html#ad2e15b23d9b04ca5444dc8c50d666ed7">getUObject</a>(<span class="keyword">const</span> std::string&amp; n);
<a name="l00233"></a>00233   <span class="keywordtype">void</span> <a class="code" href="namespaceurbi.html#a8504e39e3732950ad0331b6f0bd885e5" title="Send Urbi code (ghost connection in plugin mode, default connection in remote mode).">uobject_unarmorAndSend</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* str);
<a name="l00234"></a>00234   <span class="keywordtype">void</span> <a class="code" href="namespaceurbi.html#a8346eae9fc382fb817fef6c94d175c79">send</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* str);
<a name="l00235"></a>00235   <span class="keywordtype">void</span> <a class="code" href="namespaceurbi.html#a8346eae9fc382fb817fef6c94d175c79">send</a>(<span class="keyword">const</span> std::string&amp;s);
<a name="l00236"></a>00236   <span class="keywordtype">void</span> <a class="code" href="namespaceurbi.html#a8346eae9fc382fb817fef6c94d175c79">send</a>(<span class="keyword">const</span> <span class="keywordtype">void</span>* buf, <span class="keywordtype">size_t</span> size);
<a name="l00237"></a>00237   <a class="code" href="namespaceurbi.html#af949b0f3e9909be6b1f43cf89b975e15" title="Possible UObject running modes.">UObjectMode</a> <a class="code" href="namespaceurbi.html#a95aa70254f4507c1fb94e6543035fb3c">getRunningMode</a>();
<a name="l00238"></a>00238   <span class="keywordtype">bool</span> <a class="code" href="namespaceurbi.html#aa4360b37a87c1ab021dccd681ab7b2d9">isPluginMode</a>();
<a name="l00239"></a>00239   <span class="keywordtype">bool</span> <a class="code" href="namespaceurbi.html#a1374b111f8e167c252ea89cfb8f93837">isRemoteMode</a>();
<a name="l00240"></a>00240 
<a name="l00241"></a>00241 
<a name="l00242"></a>00242 
<a name="l00244"></a>00244   <a class="code" href="export_8hh.html#ab57e1bcd66a59b3fcf05ff8ec01c1d64">URBI_SDK_API</a> <span class="keywordtype">void</span> <a class="code" href="namespaceurbi.html#a722864d02ec1013fe6d84cb07ebbd5cc" title="Set maximum number of threads to use for threaded calls (0=unlimited).">setThreadLimit</a>(<span class="keywordtype">size_t</span> nThreads);
<a name="l00246"></a>00246   <a class="code" href="export_8hh.html#ab57e1bcd66a59b3fcf05ff8ec01c1d64">URBI_SDK_API</a> std::string <a class="code" href="namespaceurbi.html#a243d29551c0924234d94922d22e4350a" title="Return current hostname mangled to fit into an urbiscript variable name.">getFilteredHostname</a>();
<a name="l00247"></a>00247 
<a name="l00248"></a><a class="code" href="namespaceurbi.html#a946dd6c85687473a70271026ef98707b">00248</a>   <span class="keyword">typedef</span> <span class="keywordtype">int</span> UReturn;
<a name="l00254"></a><a class="code" href="classurbi_1_1_u_object.html">00254</a>   <span class="keyword">class </span><a class="code" href="export_8hh.html#ab57e1bcd66a59b3fcf05ff8ec01c1d64">URBI_SDK_API</a> <a class="code" href="classurbi_1_1_u_object.html" title="Main UObject class definition Each UObject instance corresponds to an URBI object.">UObject</a>: <span class="keyword">public</span> <a class="code" href="classurbi_1_1_u_context.html" title="Methods available in both UObject and UVar Wrapper around UContextImpl to enable access through inher...">UContext</a>
<a name="l00255"></a>00255   {
<a name="l00256"></a>00256   <span class="keyword">public</span>:
<a name="l00257"></a>00257 
<a name="l00258"></a>00258     <a class="code" href="classurbi_1_1_u_object.html" title="Main UObject class definition Each UObject instance corresponds to an URBI object.">UObject</a>(<span class="keyword">const</span> std::string&amp;, <a class="code" href="classurbi_1_1impl_1_1_u_context_impl.html">impl::UContextImpl</a>* impl = 0);
<a name="l00260"></a>00260     <a class="code" href="classurbi_1_1_u_object.html" title="Main UObject class definition Each UObject instance corresponds to an URBI object.">UObject</a>(<span class="keywordtype">int</span>, <a class="code" href="classurbi_1_1impl_1_1_u_context_impl.html">impl::UContextImpl</a>* impl = 0);
<a name="l00261"></a>00261     <span class="keyword">virtual</span> ~<a class="code" href="classurbi_1_1_u_object.html" title="Main UObject class definition Each UObject instance corresponds to an URBI object.">UObject</a>();
<a name="l00262"></a>00262 
<a name="l00263"></a>00263 
<a name="l00264"></a>00264     <span class="comment">// This call registers both an UObject (say of type</span>
<a name="l00265"></a>00265     <span class="comment">// UObjectDerived), and a callback working on it (named here</span>
<a name="l00266"></a>00266     <span class="comment">// fun).</span>
<a name="l00267"></a>00267 
<a name="l00268"></a>00268     <span class="comment">// These macros provide the following callbacks :</span>
<a name="l00269"></a>00269     <span class="comment">// Notify</span>
<a name="l00270"></a>00270     <span class="comment">// Access    | const std::string&amp; | F        | const</span>
<a name="l00271"></a>00271     <span class="comment">// Change    | urbi::UVar&amp;        | F        | non-const</span>
<a name="l00272"></a>00272 
<a name="l00273"></a>00273 <span class="preprocessor"># ifdef DOXYGEN</span>
<a name="l00274"></a>00274 <span class="preprocessor"></span>    <span class="comment">// Doxygen does not handle macros very well so feed it simplified code.</span>
<a name="l00275"></a>00275 
<a name="l00289"></a>00289     <span class="keywordtype">void</span> UNotifyChange(<a class="code" href="classurbi_1_1_u_var.html" title="UVar class definition.">UVar</a>&amp; v, <span class="keywordtype">void</span> (<a class="code" href="classurbi_1_1_u_object.html" title="Main UObject class definition Each UObject instance corresponds to an URBI object.">UObject</a>::*fun)(<a class="code" href="classurbi_1_1_u_var.html" title="UVar class definition.">UVar</a>&amp;));
<a name="l00290"></a>00290 
<a name="l00295"></a>00295     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;
<a name="l00296"></a>00296     <span class="keywordtype">void</span> UNotifyChange(<a class="code" href="classurbi_1_1_u_var.html" title="UVar class definition.">UVar</a>&amp; v, <span class="keywordtype">void</span> (<a class="code" href="classurbi_1_1_u_object.html" title="Main UObject class definition Each UObject instance corresponds to an URBI object.">UObject</a>::*fun)(T));
<a name="l00297"></a>00297 
<a name="l00304"></a>00304     <span class="keywordtype">void</span> UNotifyThreadedChange(<a class="code" href="classurbi_1_1_u_var.html" title="UVar class definition.">UVar</a>&amp; v, <span class="keywordtype">void</span> (<a class="code" href="classurbi_1_1_u_object.html" title="Main UObject class definition Each UObject instance corresponds to an URBI object.">UObject</a>::*fun)(<a class="code" href="classurbi_1_1_u_var.html" title="UVar class definition.">UVar</a>&amp;), <a class="code" href="namespaceurbi.html#a4dec125e7df86e9542d1d9ea9906a433" title="Locking model.">LockMode</a> m);
<a name="l00305"></a>00305 
<a name="l00313"></a>00313     <span class="keywordtype">void</span> UNotifyAccess(<a class="code" href="classurbi_1_1_u_var.html" title="UVar class definition.">UVar</a>&amp; v, <span class="keywordtype">void</span> (<a class="code" href="classurbi_1_1_u_object.html" title="Main UObject class definition Each UObject instance corresponds to an URBI object.">UObject</a>::*fun)(<a class="code" href="classurbi_1_1_u_var.html" title="UVar class definition.">UVar</a>&amp;));
<a name="l00314"></a>00314     <span class="keywordtype">void</span> UNotifyThreadedAccess(<a class="code" href="classurbi_1_1_u_var.html" title="UVar class definition.">UVar</a>&amp; v, <span class="keywordtype">void</span> (<a class="code" href="classurbi_1_1_u_object.html" title="Main UObject class definition Each UObject instance corresponds to an URBI object.">UObject</a>::*fun)(<a class="code" href="classurbi_1_1_u_var.html" title="UVar class definition.">UVar</a>&amp;), <a class="code" href="namespaceurbi.html#a4dec125e7df86e9542d1d9ea9906a433" title="Locking model.">LockMode</a> m);
<a name="l00315"></a>00315 
<a name="l00318"></a>00318 
<a name="l00319"></a>00319     <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00320"></a>00320     <a class="code" href="namespaceurbi.html#a3c025af4ac4c57b9e5ca9e168732e97d">TimerHandle</a>
<a name="l00321"></a>00321     USetTimer(ufloat t, <span class="keywordtype">void</span> (T::*fun)());
<a name="l00322"></a>00322 <span class="preprocessor"># else</span>
<a name="l00323"></a>00323 <span class="preprocessor"></span>
<a name="l00325"></a>00325 <span class="preprocessor"># define MakeNotify(Type, Notified,                             \</span>
<a name="l00326"></a>00326 <span class="preprocessor">                    TypeString, Owned, Name,                    \</span>
<a name="l00327"></a>00327 <span class="preprocessor">                    StoreArg)                                   \</span>
<a name="l00328"></a>00328 <span class="preprocessor">    template &lt;typename F&gt;                  \</span>
<a name="l00329"></a>00329 <span class="preprocessor">    void UNotify##Type(Notified, F fun)                         \</span>
<a name="l00330"></a>00330 <span class="preprocessor">    {                                                           \</span>
<a name="l00331"></a>00331 <span class="preprocessor">        createUCallback(*this, StoreArg, TypeString,            \</span>
<a name="l00332"></a>00332 <span class="preprocessor">                        this, fun, Name);                       \</span>
<a name="l00333"></a>00333 <span class="preprocessor">    }                                                           \</span>
<a name="l00334"></a>00334 <span class="preprocessor">    template &lt;typename F&gt;                  \</span>
<a name="l00335"></a>00335 <span class="preprocessor">    void UNotifyThreaded##Type(Notified, F fun,                 \</span>
<a name="l00336"></a>00336 <span class="preprocessor">                               LockMode lockMode)               \</span>
<a name="l00337"></a>00337 <span class="preprocessor">    {                                                           \</span>
<a name="l00338"></a>00338 <span class="preprocessor">        createUCallback(*this, StoreArg, TypeString,            \</span>
<a name="l00339"></a>00339 <span class="preprocessor">                        this, fun, Name)                        \</span>
<a name="l00340"></a>00340 <span class="preprocessor">        -&gt;setAsync(getTaskLock(lockMode, Name));                \</span>
<a name="l00341"></a>00341 <span class="preprocessor">    }</span>
<a name="l00342"></a>00342 <span class="preprocessor"></span>
<a name="l00343"></a>00343 
<a name="l00344"></a>00344 
<a name="l00346"></a>00346 <span class="preprocessor"># define MakeMetaNotify(Type, TypeString)                               \</span>
<a name="l00347"></a>00347 <span class="preprocessor">    MakeNotify(Type, UVar&amp; v, TypeString,                       \</span>
<a name="l00348"></a>00348 <span class="preprocessor">                      v.owned, v.get_name (),                           \</span>
<a name="l00349"></a>00349 <span class="preprocessor">                      v.get_temp()?new UVar(v.get_name(), ctx_):&amp;v);    \</span>
<a name="l00350"></a>00350 <span class="preprocessor">    MakeNotify(Type, const std::string&amp; name, TypeString,       \</span>
<a name="l00351"></a>00351 <span class="preprocessor">                      false, name, new UVar(name, ctx_));</span>
<a name="l00352"></a>00352 <span class="preprocessor"></span>
<a name="l00354"></a>00354     MakeMetaNotify(Access, <span class="stringliteral">&quot;varaccess&quot;</span>);
<a name="l00355"></a>00355 
<a name="l00357"></a>00357     MakeMetaNotify(Change, <span class="stringliteral">&quot;var&quot;</span>);
<a name="l00358"></a>00358 
<a name="l00359"></a>00359 <span class="preprocessor"># undef MakeNotify</span>
<a name="l00360"></a>00360 <span class="preprocessor"></span><span class="preprocessor"># undef MakeMEtaNotify</span>
<a name="l00361"></a>00361 <span class="preprocessor"></span>
<a name="l00363"></a>00363 <span class="preprocessor"># define MKUSetTimer(Const, Useless)                                    \</span>
<a name="l00364"></a>00364 <span class="preprocessor">    template &lt;class T, class R&gt;                                         \</span>
<a name="l00365"></a>00365 <span class="preprocessor">    TimerHandle USetTimer(ufloat t, R (T::*fun) () Const)               \</span>
<a name="l00366"></a>00366 <span class="preprocessor">    {                                                                   \</span>
<a name="l00367"></a>00367 <span class="preprocessor">      return (new UTimerCallbackobj&lt;T&gt; (__name, t,                      \</span>
<a name="l00368"></a>00368 <span class="preprocessor">                                dynamic_cast&lt;T*&gt;(this),                 \</span>
<a name="l00369"></a>00369 <span class="preprocessor">                                boost::bind(fun, dynamic_cast&lt;T*&gt;(this)),\</span>
<a name="l00370"></a>00370 <span class="preprocessor">                                ctx_))                                  \</span>
<a name="l00371"></a>00371 <span class="preprocessor">        -&gt;handle_get();                                                 \</span>
<a name="l00372"></a>00372 <span class="preprocessor">    }</span>
<a name="l00373"></a>00373 <span class="preprocessor"></span>
<a name="l00374"></a>00374     MKUSetTimer (, );
<a name="l00375"></a>00375     MKUSetTimer (<span class="keyword">const</span>, );
<a name="l00376"></a>00376 
<a name="l00377"></a>00377 <span class="preprocessor"># undef MKUSetTimer</span>
<a name="l00378"></a>00378 <span class="preprocessor"></span>
<a name="l00380"></a>00380     <span class="keywordtype">bool</span> removeTimer(<a class="code" href="namespaceurbi.html#a3c025af4ac4c57b9e5ca9e168732e97d">TimerHandle</a> h);
<a name="l00381"></a>00381 
<a name="l00382"></a>00382 <span class="preprocessor"># endif //DOXYGEN</span>
<a name="l00383"></a>00383 <span class="preprocessor"></span>
<a name="l00385"></a>00385     <span class="keywordtype">void</span> USync(<a class="code" href="classurbi_1_1_u_var.html" title="UVar class definition.">UVar</a> &amp;v);
<a name="l00386"></a>00386 
<a name="l00388"></a><a class="code" href="classurbi_1_1_u_object.html#a5219a510e8a76ddec423c4d44fc5ee4c">00388</a>     std::string __name;
<a name="l00390"></a><a class="code" href="classurbi_1_1_u_object.html#a3d05b0de9a003e2480f4a8099294d277">00390</a>     std::string classname;
<a name="l00392"></a><a class="code" href="classurbi_1_1_u_object.html#acd0afd29dbfc5426103831973aec082e">00392</a>     <span class="keywordtype">bool</span> derived;
<a name="l00393"></a>00393 
<a name="l00394"></a><a class="code" href="classurbi_1_1_u_object.html#aa23def271cad6323d0e5cc84c20a8ed6">00394</a>     <a class="code" href="namespaceurbi.html#a96c8d31b4c0b49d4700a2a9df3d92a6d">UObjectList</a> members;
<a name="l00395"></a>00395 
<a name="l00397"></a><a class="code" href="classurbi_1_1_u_object.html#a6c49763fe12d36f323df5bff98d92455">00397</a>     <a class="code" href="classurbi_1_1_u_object_hub.html" title="Main UObjectHub class definition.">UObjectHub</a>* objecthub;
<a name="l00398"></a>00398 
<a name="l00401"></a>00401     <span class="keywordtype">void</span> USetUpdate(ufloat period);
<a name="l00402"></a>00402     <span class="keyword">virtual</span> <span class="keywordtype">int</span> update();
<a name="l00403"></a>00403 
<a name="l00404"></a>00404 
<a name="l00409"></a>00409 
<a name="l00411"></a>00411 <span class="preprocessor">#ifdef BUILDING_URBI_SDK</span>
<a name="l00412"></a>00412 <span class="preprocessor"></span><span class="preprocessor"># define URBI_SDK_DEPRECATED</span>
<a name="l00413"></a>00413 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00414"></a><a class="code" href="uobject_8hh.html#a077d1230253976963ef1b43a289a7c06">00414</a> <span class="preprocessor"></span><span class="preprocessor"># define URBI_SDK_DEPRECATED ATTRIBUTE_DEPRECATED</span>
<a name="l00415"></a>00415 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00416"></a>00416 <span class="preprocessor"></span>    <a class="code" href="uobject_8hh.html#a077d1230253976963ef1b43a289a7c06" title="Set autogrouping facility for each new subclass created.">URBI_SDK_DEPRECATED</a>
<a name="l00417"></a>00417     <span class="keywordtype">void</span> UAutoGroup();
<a name="l00419"></a>00419     <a class="code" href="uobject_8hh.html#a077d1230253976963ef1b43a289a7c06" title="Set autogrouping facility for each new subclass created.">URBI_SDK_DEPRECATED</a>
<a name="l00420"></a>00420     <span class="keyword">virtual</span> <span class="keywordtype">void</span> addAutoGroup();
<a name="l00421"></a>00421 
<a name="l00423"></a>00423     <a class="code" href="uobject_8hh.html#a077d1230253976963ef1b43a289a7c06" title="Set autogrouping facility for each new subclass created.">URBI_SDK_DEPRECATED</a>
<a name="l00424"></a>00424     <span class="keyword">virtual</span> <span class="keywordtype">void</span> UJoinGroup(<span class="keyword">const</span> std::string&amp; gpname);
<a name="l00425"></a>00425 
<a name="l00427"></a>00427     <a class="code" href="uobject_8hh.html#a077d1230253976963ef1b43a289a7c06" title="Set autogrouping facility for each new subclass created.">URBI_SDK_DEPRECATED</a>
<a name="l00428"></a><a class="code" href="classurbi_1_1_u_object.html#a371f4dd6782db02bab8716081924df9d">00428</a>     <span class="keywordtype">bool</span> autogroup;
<a name="l00429"></a>00429 <span class="preprocessor">#undef DEPRECATED</span>
<a name="l00430"></a>00430 <span class="preprocessor"></span>
<a name="l00431"></a>00431 
<a name="l00433"></a>00433     <span class="keywordtype">int</span> voidfun();
<a name="l00434"></a>00434 
<a name="l00436"></a><a class="code" href="classurbi_1_1_u_object.html#ae99fae93f153f941e51ccaabaa38c8b5">00436</a>     <span class="keywordtype">bool</span> remote;
<a name="l00437"></a>00437 
<a name="l00439"></a>00439     <span class="keywordtype">void</span> clean();
<a name="l00440"></a>00440 
<a name="l00442"></a>00442     libport::ThreadPool::rTaskLock getTaskLock(<a class="code" href="namespaceurbi.html#a4dec125e7df86e9542d1d9ea9906a433" title="Locking model.">LockMode</a> m,
<a name="l00443"></a>00443                                                <span class="keyword">const</span> std::string&amp; what);
<a name="l00444"></a>00444 
<a name="l00447"></a><a class="code" href="classurbi_1_1_u_object.html#a678767c71820fcba74159608f6cbbc0e">00447</a>     <a class="code" href="classurbi_1_1_u_var.html" title="UVar class definition.">UVar</a> load;
<a name="l00448"></a>00448 
<a name="l00449"></a><a class="code" href="classurbi_1_1_u_object.html#a4cdfb51aeec4a2ced681da8441a2ed93">00449</a>     <a class="code" href="classurbi_1_1base_u_r_b_i_starter.html">baseURBIStarter</a>* cloner;
<a name="l00450"></a>00450 
<a name="l00451"></a>00451     <a class="code" href="classurbi_1_1impl_1_1_u_object_impl.html">impl::UObjectImpl</a>* impl_get();
<a name="l00452"></a>00452 
<a name="l00453"></a>00453     <span class="comment">// Override me to have your own LOCK_CLASS task lock.</span>
<a name="l00454"></a>00454     <span class="keyword">virtual</span> libport::ThreadPool::rTaskLock getClassTaskLock();
<a name="l00455"></a>00455   <span class="keyword">private</span>:
<a name="l00458"></a><a class="code" href="classurbi_1_1_u_object.html#a7ba2715ba4e475a7478d5c7b29348d4f">00458</a>     UObjectData* objectData;
<a name="l00459"></a>00459 
<a name="l00460"></a><a class="code" href="classurbi_1_1_u_object.html#a0b451fb6727c64ea44b980707fdf1d8b">00460</a>     <a class="code" href="classurbi_1_1impl_1_1_u_object_impl.html">impl::UObjectImpl</a>* impl_;
<a name="l00461"></a>00461     boost::unordered_map&lt;std::string, libport::ThreadPool::rTaskLock&gt;
<a name="l00462"></a><a class="code" href="classurbi_1_1_u_object.html#a9a961832dcff5be24eee6cfda18b604c">00462</a>     taskLocks_;
<a name="l00464"></a><a class="code" href="classurbi_1_1_u_object.html#a064ca8707d3e458596ec904cb79ee6db">00464</a>     libport::ThreadPool::rTaskLock taskLock_;
<a name="l00465"></a>00465   };
<a name="l00466"></a>00466 
<a name="l00467"></a>00467 <span class="preprocessor">#ifndef NO_UOBJECT_CASTER</span>
<a name="l00468"></a>00468 <span class="preprocessor"></span>  <span class="comment">// Provide cast support to UObject*</span>
<a name="l00469"></a><a class="code" href="structurbi_1_1uvalue__caster_3_01_u_object_01_5_01_4.html">00469</a>   <span class="keyword">template</span>&lt;&gt; <span class="keyword">struct </span><a class="code" href="structurbi_1_1uvalue__caster.html">uvalue_caster</a>&lt;<a class="code" href="classurbi_1_1_u_object.html" title="Main UObject class definition Each UObject instance corresponds to an URBI object.">UObject</a>*&gt;
<a name="l00470"></a>00470   {
<a name="l00471"></a>00471     <a class="code" href="classurbi_1_1_u_object.html" title="Main UObject class definition Each UObject instance corresponds to an URBI object.">UObject</a>* operator()(<a class="code" href="classurbi_1_1_u_value.html" title="Container for a value that handles all types known to URBI.">urbi::UValue</a>&amp; v);
<a name="l00472"></a>00472   };
<a name="l00473"></a>00473   <a class="code" href="classurbi_1_1_u_value.html" title="Container for a value that handles all types known to URBI.">UValue</a>&amp; <a class="code" href="namespaceurbi.html#a4c1528bf5e147f24902370f84e4c3aee">operator,</a>(<a class="code" href="classurbi_1_1_u_value.html" title="Container for a value that handles all types known to URBI.">UValue</a>&amp;a, <span class="keyword">const</span> <a class="code" href="classurbi_1_1_u_object.html" title="Main UObject class definition Each UObject instance corresponds to an URBI object.">UObject</a>* b);
<a name="l00474"></a>00474 <span class="preprocessor">#endif</span>
<a name="l00475"></a>00475 <span class="preprocessor"></span>} <span class="comment">// end namespace urbi</span>
<a name="l00476"></a>00476 
<a name="l00477"></a>00477 <span class="comment">// This file needs the definition of UObject, so included last.</span>
<a name="l00478"></a>00478 <span class="comment">// To be cleaned later.</span>
<a name="l00479"></a>00479 <span class="preprocessor"># include &lt;<a class="code" href="ustarter_8hh.html">urbi/ustarter.hh</a>&gt;</span>
<a name="l00480"></a>00480 
<a name="l00481"></a>00481 <span class="preprocessor"># include &lt;<a class="code" href="uobject_8hxx.html">urbi/uobject.hxx</a>&gt;</span>
<a name="l00482"></a>00482 
<a name="l00483"></a>00483 <span class="preprocessor"># include &lt;libport/warning-pop.hh&gt;</span>
<a name="l00484"></a>00484 
<a name="l00485"></a>00485 <span class="preprocessor">#endif // ! URBI_UOBJECT_HH</span>
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
